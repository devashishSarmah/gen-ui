{
  "info": {
    "name": "Gen-UI Backend API",
    "description": "REST API collection for the Gen-UI backend.\n\nFlow (happy path):\n1) Register user\n2) Login (stores {{accessToken}})\n3) Create conversation (stores {{conversationId}})\n4) List/get/update/delete conversation, fetch messages\n5) Admin replay flow (start session -> next/previous/jump -> export -> end)\n\nNotes:\n- Socket.IO flows are handled by the gateway and are not REST endpoints. After you have a conversationId and token, the frontend connects via Socket.IO and uses events: join-conversation, prompt, interaction, get-state.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:3000" },
    { "key": "accessToken", "value": "" },
    { "key": "conversationId", "value": "" },
    { "key": "frameIndex", "value": "0" },
    { "key": "search", "value": "" }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      { "key": "token", "value": "{{accessToken}}", "type": "string" }
    ]
  },
  "item": [
    {
      "name": "Flow - Quick Start",
      "description": "Run these in order to exercise the primary flow.",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "register"]
            }
          }
        },
        {
          "name": "Login (stores accessToken)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "if (json && json.access_token) {",
                  "  pm.collectionVariables.set('accessToken', json.access_token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Create Conversation (stores conversationId)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "if (json && json.id) {",
                  "  pm.collectionVariables.set('conversationId', json.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"My Conversation\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/conversations",
              "host": ["{{baseUrl}}"],
              "path": ["conversations"]
            }
          }
        },
        {
          "name": "List Conversations",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations",
              "host": ["{{baseUrl}}"],
              "path": ["conversations"]
            }
          }
        },
        {
          "name": "Get Conversation",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}"]
            }
          }
        },
        {
          "name": "Get Messages",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}", "messages"]
            }
          }
        },
        {
          "name": "Update Conversation Title",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Title\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}"]
            }
          }
        },
        {
          "name": "Delete Conversation",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "register"]
            }
          }
        },
        {
          "name": "Login (stores accessToken)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "if (json && json.access_token) {",
                  "  pm.collectionVariables.set('accessToken', json.access_token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Profile",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/auth/profile",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "profile"]
            }
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get Me",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["users", "me"]
            }
          }
        },
        {
          "name": "Update Me",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"new-email@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/me",
              "host": ["{{baseUrl}}"],
              "path": ["users", "me"]
            }
          }
        }
      ]
    },
    {
      "name": "Conversations",
      "item": [
        {
          "name": "Create",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"My Conversation\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/conversations",
              "host": ["{{baseUrl}}"],
              "path": ["conversations"]
            }
          }
        },
        {
          "name": "List",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations",
              "host": ["{{baseUrl}}"],
              "path": ["conversations"]
            }
          }
        },
        {
          "name": "Search",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations?search={{search}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations"],
              "query": [
                { "key": "search", "value": "{{search}}" }
              ]
            }
          }
        },
        {
          "name": "Get By Id",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}"]
            }
          }
        },
        {
          "name": "Get Messages",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}", "messages"]
            }
          }
        },
        {
          "name": "Update",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Title\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}"]
            }
          }
        },
        {
          "name": "Delete",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/conversations/{{conversationId}}",
              "host": ["{{baseUrl}}"],
              "path": ["conversations", "{{conversationId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Admin Replay",
      "item": [
        {
          "name": "Start Replay",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/start",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "start"]
            }
          }
        },
        {
          "name": "Get Session",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/session",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "session"]
            }
          }
        },
        {
          "name": "Get Frame",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/frame/{{frameIndex}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "frame", "{{frameIndex}}"]
            }
          }
        },
        {
          "name": "Next Frame",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/next",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "next"]
            }
          }
        },
        {
          "name": "Previous Frame",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/previous",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "previous"]
            }
          }
        },
        {
          "name": "Jump To Frame",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/jump-to?frameIndex={{frameIndex}}",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "jump-to"],
              "query": [
                { "key": "frameIndex", "value": "{{frameIndex}}" }
              ]
            }
          }
        },
        {
          "name": "Export Audit Trail",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/export-audit-trail",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "export-audit-trail"]
            }
          }
        },
        {
          "name": "Get Snapshots",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/snapshots",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "snapshots"]
            }
          }
        },
        {
          "name": "Get Events",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/events",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "events"]
            }
          }
        },
        {
          "name": "End Replay",
          "request": {
            "method": "POST",
            "url": {
              "raw": "{{baseUrl}}/admin/replay/conversations/{{conversationId}}/end",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "replay", "conversations", "{{conversationId}}", "end"]
            }
          }
        }
      ]
    },
    {
      "name": "Health",
      "item": [
        {
          "name": "Health",
          "request": {
            "auth": { "type": "noauth" },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": ["{{baseUrl}}"],
              "path": ["health"]
            }
          }
        },
        {
          "name": "Liveness",
          "request": {
            "auth": { "type": "noauth" },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/health/live",
              "host": ["{{baseUrl}}"],
              "path": ["health", "live"]
            }
          }
        },
        {
          "name": "Readiness",
          "request": {
            "auth": { "type": "noauth" },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/health/ready",
              "host": ["{{baseUrl}}"],
              "path": ["health", "ready"]
            }
          }
        }
      ]
    }
  ]
}
